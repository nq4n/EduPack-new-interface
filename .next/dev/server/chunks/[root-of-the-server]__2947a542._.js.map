{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///home/user/EduPack-new-interface/lib/ai/orchestrator.ts"],"sourcesContent":["\nimport { EditorProject, BuildLessonResult } from \"@/lib/scorm/types\";\n\n/**\n * Orchestrates the creation of a lesson package using a multi-level AI approach.\n *\n * @param teacherInput The initial input from the teacher (e.g., a simple prompt).\n * @param language The target language for the lesson.\n * @returns A full lesson package with supplementary metadata.\n */\nexport async function buildLessonPackage(teacherInput: string, language: \"en\" | \"ar\"): Promise<BuildLessonResult> {\n    console.log(`Orchestrator: Starting lesson build for prompt: \"${teacherInput}\"`);\n\n    // --- Level 2: Big AI Model ---\n    // First, call the LLM to generate the core content and structure of the lesson.\n    // This is necessary because we need the content before we can validate or analyze it.\n    const generatedProject = await generateLessonFromPrompt(teacherInput, language);\n\n    // Create a complete project structure from the partial data returned by the LLM\n    const project: EditorProject = {\n        id: `proj-${Date.now()}`,\n        title: \"Untitled Project\",\n        version: \"1.0\",\n        theme: { direction: language === 'ar' ? 'rtl' : 'ltr', styles: {} },\n        pages: [],\n        ...generatedProject, // Override defaults with LLM output\n    };\n    \n    console.log(\"Orchestrator: Lesson content generated by Level 2 AI.\", project);\n\n    // --- Level 0: Rules & Simple Logic ---\n    // Now, run validation rules on the generated content.\n    const warnings = validateProject(project);\n    console.log(\"Orchestrator: Validation complete. Warnings found:\", warnings);\n\n    // --- Level 1: Simple ML Models ---\n    // Run predictions and recommendations on the generated content.\n    const [predictedDifficulty, recommendedTags] = await Promise.all([\n        predictDifficulty(project),\n        recommendTags(project)\n    ]);\n    console.log(`Orchestrator: Level 1 ML predictions - Difficulty: ${predictedDifficulty}, Tags: ${recommendedTags.join(', ')}`);\n\n    // --- Final Combination ---\n    // Combine all results into a single, structured response.\n    const result: BuildLessonResult = {\n        project,\n        warnings,\n        metadata: {\n            predictedDifficulty,\n            recommendedTags,\n        }\n    };\n\n    console.log(\"Orchestrator: Build complete.\");\n    return result;\n}\n\n// You could add other orchestrator functions here, for example:\n// export async function evaluateStudentWriting(submission: string) { ... }\n// export async function recommendNextSteps(studentStats: any) { ... }\n"],"names":[],"mappings":";;;;AAUO,eAAe,mBAAmB,YAAoB,EAAE,QAAqB;IAChF,QAAQ,GAAG,CAAC,CAAC,iDAAiD,EAAE,aAAa,CAAC,CAAC;IAE/E,gCAAgC;IAChC,gFAAgF;IAChF,sFAAsF;IACtF,MAAM,mBAAmB,MAAM,yBAAyB,cAAc;IAEtE,gFAAgF;IAChF,MAAM,UAAyB;QAC3B,IAAI,CAAC,KAAK,EAAE,KAAK,GAAG,IAAI;QACxB,OAAO;QACP,SAAS;QACT,OAAO;YAAE,WAAW,aAAa,OAAO,QAAQ;YAAO,QAAQ,CAAC;QAAE;QAClE,OAAO,EAAE;QACT,GAAG,gBAAgB;IACvB;IAEA,QAAQ,GAAG,CAAC,yDAAyD;IAErE,wCAAwC;IACxC,sDAAsD;IACtD,MAAM,WAAW,gBAAgB;IACjC,QAAQ,GAAG,CAAC,sDAAsD;IAElE,oCAAoC;IACpC,gEAAgE;IAChE,MAAM,CAAC,qBAAqB,gBAAgB,GAAG,MAAM,QAAQ,GAAG,CAAC;QAC7D,kBAAkB;QAClB,cAAc;KACjB;IACD,QAAQ,GAAG,CAAC,CAAC,mDAAmD,EAAE,oBAAoB,QAAQ,EAAE,gBAAgB,IAAI,CAAC,OAAO;IAE5H,4BAA4B;IAC5B,0DAA0D;IAC1D,MAAM,SAA4B;QAC9B;QACA;QACA,UAAU;YACN;YACA;QACJ;IACJ;IAEA,QAAQ,GAAG,CAAC;IACZ,OAAO;AACX,EAEA,gEAAgE;CAChE,2EAA2E;CAC3E,sEAAsE"}},
    {"offset": {"line": 99, "column": 0}, "map": {"version":3,"sources":["file:///home/user/EduPack-new-interface/app/api/ai/lesson/build/route.ts"],"sourcesContent":["\nimport { NextResponse } from \"next/server\";\nimport { buildLessonPackage } from \"@/lib/ai/orchestrator\";\n\n/**\n * API route handler for building a lesson package.\n * Expects a POST request with a JSON body containing 'prompt' and 'language'.\n */\nexport async function POST(request: Request) {\n    try {\n        const body = await request.json();\n        const { prompt, language } = body;\n\n        if (!prompt) {\n            return NextResponse.json({ error: \"Prompt is required\" }, { status: 400 });\n        }\n        if (language && !['en', 'ar'].includes(language)) {\n            return NextResponse.json({ error: \"Invalid language. Must be 'en' or 'ar'.\" }, { status: 400 });\n        }\n        \n        // Call the AI orchestrator to build the lesson\n        const result = await buildLessonPackage(prompt, language || 'en');\n\n        return NextResponse.json(result);\n\n    } catch (error: any) {\n        console.error(\"[API /ai/lesson/build] Error:\", error);\n        // Return a generic error message to the client to avoid exposing implementation details.\n        return NextResponse.json({ error: \"An unexpected error occurred while building the lesson.\" }, { status: 500 });\n    }\n}\n"],"names":[],"mappings":";;;;AACA;AACA;;;AAMO,eAAe,KAAK,OAAgB;IACvC,IAAI;QACA,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,MAAM,EAAE,QAAQ,EAAE,GAAG;QAE7B,IAAI,CAAC,QAAQ;YACT,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAqB,GAAG;gBAAE,QAAQ;YAAI;QAC5E;QACA,IAAI,YAAY,CAAC;YAAC;YAAM;SAAK,CAAC,QAAQ,CAAC,WAAW;YAC9C,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA0C,GAAG;gBAAE,QAAQ;YAAI;QACjG;QAEA,+CAA+C;QAC/C,MAAM,SAAS,MAAM,IAAA,iJAAkB,EAAC,QAAQ,YAAY;QAE5D,OAAO,gJAAY,CAAC,IAAI,CAAC;IAE7B,EAAE,OAAO,OAAY;QACjB,QAAQ,KAAK,CAAC,iCAAiC;QAC/C,yFAAyF;QACzF,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA0D,GAAG;YAAE,QAAQ;QAAI;IACjH;AACJ"}}]
}