{"version":3,"sources":["../../../../components/ui/input.tsx","../../../../node_modules/lucide-react/src/icons/loader-circle.ts","../../../../app/profile/page.tsx"],"sourcesContent":["import * as React from 'react'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nfunction Input({ className, type, ...props }: React.ComponentProps<'input'>) {\r\n  return (\r\n    <input\r\n      type={type}\r\n      data-slot=\"input\"\r\n      className={cn(\r\n        'file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',\r\n        'focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]',\r\n        'aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Input }\r\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name LoaderCircle\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjEgMTJhOSA5IDAgMSAxLTYuMjE5LTguNTYiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/loader-circle\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst LoaderCircle = createLucideIcon('LoaderCircle', [\n  ['path', { d: 'M21 12a9 9 0 1 1-6.219-8.56', key: '13zald' }],\n]);\n\nexport default LoaderCircle;\n","\"use client\"\r\n\r\nimport { useCallback, useEffect, useMemo, useState } from \"react\"\r\nimport { useRouter } from \"next/navigation\"\r\nimport { Loader2, User } from \"lucide-react\"\r\nimport { toast } from \"sonner\"\r\n\r\nimport { useSupabase } from \"@/components/auth-provider\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Input } from \"@/components/ui/input\"\r\nimport { getUserProfile, updateUserProfile } from \"@/lib/user-profile\"\r\n\r\nconst languageOptions = [\r\n  { label: \"English\", value: \"en\" },\r\n  { label: \"Arabic\", value: \"ar\" },\r\n]\r\n\r\nconst normalizeLanguage = (language: string) =>\r\n  language?.toLowerCase().startsWith(\"ar\") ? \"ar\" : \"en\"\r\n\r\ntype ProfileFormState = {\r\n  fullName: string\r\n  email: string\r\n  preferredLanguage: string\r\n}\r\n\r\nexport default function ProfilePage() {\r\n  return <PersonalInfoPanel />\r\n}\r\n\r\nfunction PersonalInfoPanel() {\r\n  const { user } = useSupabase()\r\n  const router = useRouter()\r\n  const [form, setForm] = useState<ProfileFormState>({\r\n    fullName: \"\",\r\n    email: \"\",\r\n    preferredLanguage: \"\",\r\n  })\r\n  const [loading, setLoading] = useState(true)\r\n  const [saving, setSaving] = useState(false)\r\n  const [error, setError] = useState<string | null>(null)\r\n\r\n  const isLoggedOut = useMemo(() => !user, [user])\r\n\r\n  const loadProfile = useCallback(async () => {\r\n    if (!user) {\r\n      setLoading(false)\r\n      return\r\n    }\r\n\r\n    setLoading(true)\r\n    setError(null)\r\n    const { data: profile, error } = await getUserProfile(user.id)\r\n    if (error) {\r\n      setError(\"Could not load your profile. Please try again.\")\r\n    } else if (profile) {\r\n      initializeForm(profile)\r\n    }\r\n    setLoading(false)\r\n  }, [user])\r\n\r\n  useEffect(() => {\r\n    loadProfile()\r\n  }, [loadProfile])\r\n\r\n  const initializeForm = (profile: {\r\n    full_name?: string | null\r\n    email?: string | null\r\n    preferred_language?: string | null\r\n  }) => {\r\n    setForm({\r\n      fullName: profile.full_name ?? \"\",\r\n      email: profile.email ?? user?.email ?? \"\",\r\n      preferredLanguage: normalizeLanguage(profile.preferred_language ?? \"en\"),\r\n    })\r\n  }\r\n\r\n  const handleInputChange =\r\n    (field: keyof ProfileFormState) =>\r\n    (event: React.ChangeEvent<HTMLInputElement>) => {\r\n      setForm((current) => ({ ...current, [field]: event.target.value }))\r\n    }\r\n\r\n  const handleSelectChange =\r\n    (field: keyof ProfileFormState) =>\r\n    (event: React.ChangeEvent<HTMLSelectElement>) => {\r\n      setForm((current) => ({ ...current, [field]: event.target.value }))\r\n    }\r\n\r\n  const handleSave = async () => {\r\n    if (!user) {\r\n      setError(\"You must be logged in to update your profile.\")\r\n      return\r\n    }\r\n\r\n    setSaving(true)\r\n    setError(null)\r\n\r\n    const { error } = await updateUserProfile(user.id, {\r\n      full_name: form.fullName,\r\n      preferred_language: normalizeLanguage(form.preferredLanguage || \"en\"),\r\n    })\r\n\r\n    setSaving(false)\r\n\r\n    if (error) {\r\n      setError(\"Failed to save your changes. Please try again.\")\r\n      return\r\n    }\r\n\r\n    toast.success(\"Profile updated\")\r\n    await loadProfile()\r\n    router.refresh()\r\n  }\r\n\r\n  if (isLoggedOut) {\r\n    return (\r\n      <div className=\"space-y-4\">\r\n        <h2 className=\"text-2xl font-bold text-foreground\">Profile</h2>\r\n        <p className=\"text-muted-foreground\">\r\n          Please sign in to view your profile.\r\n        </p>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"space-y-4\">\r\n        <h2 className=\"text-2xl font-bold text-foreground\">Profile</h2>\r\n        <div className=\"flex items-center gap-2 text-muted-foreground\">\r\n          <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n          <span>Syncing your profile with the database...</span>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div>\r\n        <h2 className=\"text-2xl font-bold text-foreground mb-6\">\r\n          Personal Information\r\n        </h2>\r\n\r\n        {/* Avatar */}\r\n        <div className=\"mb-8\">\r\n          <label className=\"block text-sm font-semibold text-foreground mb-2\">\r\n            Profile Picture\r\n          </label>\r\n          <div className=\"flex items-center gap-4\">\r\n            <div className=\"w-20 h-20 bg-primary/10 rounded-full flex items-center justify-center\">\r\n              <User className=\"h-10 w-10 text-primary\" />\r\n            </div>\r\n            <Button variant=\"outline\" size=\"sm\" disabled>\r\n              Upload Photo\r\n            </Button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Form */}\r\n        <div className=\"grid md:grid-cols-2 gap-6\">\r\n          <div>\r\n            <label className=\"block text-sm font-semibold text-foreground mb-2\">\r\n              Full Name\r\n            </label>\r\n            <Input\r\n              value={form.fullName}\r\n              onChange={handleInputChange(\"fullName\")}\r\n              disabled={loading}\r\n            />\r\n          </div>\r\n          <div>\r\n            <label className=\"block text-sm font-semibold text-foreground mb-2\">\r\n              Email\r\n            </label>\r\n            <Input value={form.email} type=\"email\" disabled />\r\n          </div>\r\n          <div className=\"md:col-span-2\">\r\n            <label className=\"block text-sm font-semibold text-foreground mb-2\">\r\n              Preferred Language\r\n            </label>\r\n            <select\r\n              className=\"w-full px-3 py-2 rounded-lg border border-input bg-background text-sm\"\r\n              value={form.preferredLanguage}\r\n              onChange={handleSelectChange(\"preferredLanguage\")}\r\n              disabled={loading}\r\n            >\r\n              <option value=\"\" disabled>\r\n                Select a language\r\n              </option>\r\n              {languageOptions.map((language) => (\r\n                <option key={language.value} value={language.value}>\r\n                  {language.label}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n        </div>\r\n\r\n        {error && <p className=\"text-sm text-destructive pt-2\">{error}</p>}\r\n\r\n        <div className=\"pt-6\">\r\n          <Button onClick={handleSave} disabled={loading || saving}>\r\n            {saving ? \"Saving...\" : \"Save Changes\"}\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"uDAEA,EAAA,EAAA,CAAA,CAAA,OAEA,SAAS,EAAM,WAAE,CAAS,CAAE,MAAI,CAAE,GAAG,EAAsC,EACzE,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAM,EACN,YAAU,QACV,UAAW,CAAA,EAAA,EAAA,EAAA,AAAE,EACX,6bACA,gFACA,yGACA,GAED,GAAG,CAAK,EAGf,8CCLM,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAe,CAAf,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAe,OAAA,EAAiB,cAAgB,CAAA,CAAA,AACpD,CAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAQ,CAAA,CAAA,AAAE,EAAG,CAA+B,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAK,QAAA,CAAU,CAAA,CAC7D,CAAA,CAAA,gECbD,EAAA,CAAA,CAAA,OACA,EAAA,CAAA,CAAA,OACA,EAAA,CAAA,CAAA,OAAA,EAAA,CAAA,CAAA,OACA,EAAA,CAAA,CAAA,OAEA,EAAA,CAAA,CAAA,OACA,EAAA,CAAA,CAAA,OACA,EAAA,CAAA,CAAA","ignoreList":[1]}